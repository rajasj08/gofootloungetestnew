UPDATE `{$p}emailtemplate`  
   SET `emailtemplate_vqmod` = '&lt;file name=&quot;admin/controller/sale/contact.php&quot;&gt;\r\n	&lt;operation&gt; \r\n		&lt;search position=&quot;after&quot;&gt;&lt;![CDATA[\r\n            $this-&gt;data[''entry_message''] = $this-&gt;language-&gt;get(''entry_message''); ]]&gt;&lt;/search&gt;\r\n		&lt;add&gt;&lt;![CDATA[\r\n		$this-&gt;data[''entry_campaign_name''] = $this-&gt;language-&gt;get(''entry_campaign_name'');\r\n		$this-&gt;data[''entry_template''] = $this-&gt;language-&gt;get(''entry_template'');		\r\n		$this-&gt;data[''entry_store_auto''] = $this-&gt;language-&gt;get(''entry_store_auto'');		\r\n\r\n		$this-&gt;data[''text_select''] = $this-&gt;language-&gt;get(''text_select'');\r\n\r\n   		$this-&gt;data[''warning_template_content''] = $this-&gt;language-&gt;get(''warning_template_content'');\r\n\r\n		$this-&gt;load-&gt;model(''localisation/language'');\r\n		$this-&gt;load-&gt;model(''module/emailtemplate'');\r\n\r\n        $templates = $this-&gt;model_module_emailtemplate-&gt;getTemplates(array(\r\n			''emailtemplate_key'' =&gt; ''admin.newsletter''\r\n		));\r\n\r\n		$this-&gt;data[''templates_options''] = array();\r\n\r\n		foreach($templates as $row){\r\n			$label = $row[''emailtemplate_label''];\r\n\r\n			if($row[''emailtemplate_default'']){\r\n				$label = $this-&gt;language-&gt;get(''text_default'') . '' - '' . $label;\r\n			}\r\n\r\n			$this-&gt;data[''templates_options''][] = array(\r\n				''value'' =&gt; $row[''emailtemplate_id''],\r\n				''label'' =&gt; $label\r\n			);\r\n		}\r\n\r\n		$this-&gt;data[''languages''] = $this-&gt;model_localisation_language-&gt;getLanguages();		\r\n\r\n		$config = $this-&gt;model_module_emailtemplate-&gt;getConfig(1, true, true);\r\n        $this-&gt;data[''campaign_name''] = $config[''tracking_campaign_name''];    \r\n		 \r\n        $this-&gt;data[''templates_action''] = $this-&gt;url-&gt;link(''module/emailtemplate/get_template'', ''token=''.$this-&gt;session-&gt;data[''token''], ''SSL''); ]]&gt;&lt;/add&gt;\r\n	&lt;/operation&gt;\r\n	\r\n	&lt;operation info=&quot;Add extra info into email array&quot;&gt;\r\n		&lt;search position=&quot;replace&quot;&gt;&lt;![CDATA[\r\n			$emails[] = $customer_info[''email'']; ]]&gt;&lt;/search&gt;\r\n		&lt;add&gt;&lt;![CDATA[ $emails[] = array(\r\n				   ''customer'' =&gt; $customer_info,\r\n				   ''email'' =&gt; $customer_info[''email''],\r\n				   ''customer_id'' =&gt; $customer_info[''customer_id''],\r\n				   ''store_id'' =&gt; $customer_info[''store_id''],\r\n				   ''language_id'' =&gt; $customer_info[''language_id'']\r\n				  ); ]]&gt;&lt;/add&gt;\r\n	&lt;/operation&gt;\r\n	&lt;operation info=&quot;Add extra info into email array&quot;&gt;\r\n		&lt;search position=&quot;replace&quot;&gt;&lt;![CDATA[\r\n			$emails[$result[''customer_id'']] = $result[''email'']; ]]&gt;&lt;/search&gt;\r\n		&lt;add&gt;&lt;![CDATA[ $emails[$result[''customer_id'']] = array(\r\n				 ''email'' =&gt; $result[''email''],\r\n				 ''customer_id'' =&gt; $result[''customer_id''],\r\n				 ''store_id'' =&gt; $result[''store_id''],\r\n				 ''language_id'' =&gt; $result[''language_id'']\r\n				); ]]&gt;&lt;/add&gt;\r\n	&lt;/operation&gt;\r\n	&lt;operation info=&quot;affiliate_all&quot;&gt;\r\n		&lt;search position=&quot;replace&quot; index=&quot;3&quot;&gt;&lt;![CDATA[\r\n			$emails[] = $result[''email'']; ]]&gt;&lt;/search&gt;\r\n		&lt;add&gt;&lt;![CDATA[ $emails[$result[''affiliate_id'']] = array(\r\n				 ''email'' =&gt; $result[''email''],\r\n				 ''affiliate_id'' =&gt; $result[''affiliate_id'']\r\n				); ]]&gt;&lt;/add&gt;\r\n	&lt;/operation&gt;\r\n	&lt;operation info=&quot;affiliate&quot;&gt;\r\n		&lt;search position=&quot;replace&quot;&gt;&lt;![CDATA[\r\n			$emails[] = $affiliate_info[''email'']; ]]&gt;&lt;/search&gt;\r\n		&lt;add&gt;&lt;![CDATA[ $emails[$affiliate_info[''affiliate_id'']] = array(\r\n				   ''affiliate'' =&gt; $affiliate_info,\r\n				   ''email'' =&gt; $affiliate_info[''email''],\r\n				   ''affiliate_id'' =&gt; $affiliate_info[''affiliate_id'']\r\n				  ); ]]&gt;&lt;/add&gt;\r\n	&lt;/operation&gt;\r\n	&lt;operation info=&quot;newsletter, customer_all, product&quot;&gt;\r\n		&lt;search position=&quot;replace&quot;&gt;&lt;![CDATA[\r\n			$emails[] = $result[''email'']; ]]&gt;&lt;/search&gt;\r\n		&lt;add&gt;&lt;![CDATA[ $emails[$result[''customer_id'']] = array(\r\n				 ''email'' =&gt; $result[''email''],\r\n				 ''customer_id'' =&gt; $result[''customer_id''],\r\n				 ''store_id'' =&gt; $result[''store_id''],\r\n				 ''language_id'' =&gt; $result[''language_id'']\r\n				); ]]&gt;&lt;/add&gt;\r\n	&lt;/operation&gt;\r\n		\r\n	&lt;operation info=&quot;Move message into foreach&quot;&gt;\r\n		&lt;search position=&quot;replace&quot;&gt;&lt;![CDATA[\r\n            foreach ($emails as $email) { ]]&gt;&lt;/search&gt;\r\n		&lt;add&gt;&lt;/add&gt;\r\n	&lt;/operation&gt;  \r\n	&lt;operation&gt;\r\n		&lt;search position=&quot;before&quot;&gt;&lt;![CDATA[\r\n            $message  = ''&lt;html  ]]&gt;&lt;/search&gt;\r\n		&lt;add&gt;&lt;![CDATA[				foreach ($emails as $email) {\r\n					if(empty($email[''customer_id'']) &amp;&amp; empty($email[''affiliate_id''])) continue;\r\n\r\n					$template = new EmailTemplate($this-&gt;request, $this-&gt;registry);\r\n            \r\n					if(isset($email[''customer''])){\r\n						$template-&gt;addData($email[''customer'']);\r\n						unset($email[''customer'']);\r\n					} elseif(isset($email[''customer_id''])){\r\n						$customer_info = $this-&gt;model_sale_customer-&gt;getCustomer($email[''customer_id'']);\r\n						$template-&gt;addData($customer_info);\r\n					}\r\n\r\n					if(isset($email[''affiliate''])){\r\n						$template-&gt;addData($email[''affiliate'']);\r\n						unset($email[''affiliate'']);\r\n					} elseif(isset($email[''affiliate_id''])){\r\n						$affiliate_info = $this-&gt;model_sale_affiliate-&gt;getAffiliate($email[''affiliate_id'']);\r\n						$template-&gt;addData($affiliate_info);\r\n					}\r\n\r\n					if(isset($email[''language_id'']) &amp;&amp; $email[''language_id'']){\r\n						$language_id = $email[''language_id''];\r\n					} else {\r\n						$language_id = $this-&gt;config-&gt;get(''config_language_id'');\r\n					}\r\n			\r\n					if(isset($this-&gt;request-&gt;post[''store_auto'']) &amp;&amp; isset($email[''store_id''])){\r\n 						$store_id = $email[''store_id''];\r\n					} else {\r\n						$store_id = $this-&gt;request-&gt;post[''store_id''];\r\n					}\r\n\r\n					$template_data = array(\r\n						''key'' =&gt; ''admin.newsletter'',\r\n						''store_id'' =&gt; $store_id\r\n					);\r\n\r\n					$template-&gt;load($template_data);\r\n					\r\n					if(!empty($template-&gt;data[''emailtemplate''][''unsubscribe_text'']) &amp;&amp; in_array($this-&gt;request-&gt;post[''to''], array(''newsletter'', ''customer_all'', ''customer_group'', ''customer''))) {\r\n						$url = (isset($store_info[''url'']) ? $store_info[''url''] : HTTP_CATALOG) . ''index.php?route=account/newsletter/unsubscribe&amp;code=''.md5($email[''email'']);\r\n						$template-&gt;data[''unsubscribe''] = sprintf(html_entity_decode($template-&gt;data[''emailtemplate''][''unsubscribe_text''], ENT_QUOTES, ''UTF-8''), $url);\r\n				    }\r\n\r\n					if(!empty($this-&gt;request-&gt;post[''subject''][$language_id])){\r\n						$subject = $this-&gt;request-&gt;post[''subject''][$language_id];\r\n					} else {\r\n						$subject = $template-&gt;data[''store_name''];\r\n					}\r\n\r\n					$body = $this-&gt;request-&gt;post[''message''][$language_id];\r\n\r\n					$template-&gt;addData($email);\r\n\r\n					$template-&gt;set(''subject'', $subject);\r\n					\r\n					$template-&gt;data[''config''][''tracking_campaign_name''] = $this-&gt;request-&gt;post[''campaign_name''];\r\n		]]&gt;&lt;/add&gt;\r\n	&lt;/operation&gt;\r\n	&lt;operation&gt;\r\n		&lt;search position=&quot;replace&quot;&gt;&lt;![CDATA[\r\n            &lt;title&gt;'' . $this-&gt;request-&gt;post[''subject''] . ''&lt;/title&gt;'' ]]&gt;&lt;/search&gt;\r\n		&lt;add trim=&quot;true&quot;&gt;&lt;![CDATA[ \r\n			&lt;title&gt;'' . $subject . ''&lt;/title&gt;'' ]]&gt;&lt;/add&gt;\r\n	&lt;/operation&gt;\r\n	&lt;operation error=&quot;skip&quot;&gt;\r\n		&lt;search position=&quot;replace&quot;&gt;&lt;![CDATA[\r\n            $mail-&gt;setSubject(html_entity_decode($this-&gt;request-&gt;post[''subject''] ]]&gt;&lt;/search&gt;\r\n		&lt;add trim=&quot;true&quot;&gt;&lt;![CDATA[ \r\n			$mail-&gt;setSubject(html_entity_decode($subject ]]&gt;&lt;/add&gt;\r\n	&lt;/operation&gt;\r\n	&lt;operation error=&quot;skip&quot;&gt;\r\n		&lt;search position=&quot;replace&quot;&gt;&lt;![CDATA[\r\n            $mail-&gt;setSubject($this-&gt;request-&gt;post[''subject''] ]]&gt;&lt;/search&gt;\r\n		&lt;add trim=&quot;true&quot;&gt;&lt;![CDATA[ \r\n			$mail-&gt;setSubject($subject ]]&gt;&lt;/add&gt;\r\n	&lt;/operation&gt;\r\n	&lt;operation&gt;\r\n		&lt;search position=&quot;replace&quot;&gt;&lt;![CDATA[\r\n            html_entity_decode($this-&gt;request-&gt;post[''message'']  ]]&gt;&lt;/search&gt;\r\n		&lt;add trim=&quot;true&quot;&gt;&lt;![CDATA[ \r\n			html_entity_decode($message ]]&gt;&lt;/add&gt;\r\n	&lt;/operation&gt;\r\n	&lt;operation&gt;\r\n		&lt;search position=&quot;replace&quot;&gt;&lt;![CDATA[\r\n            $mail-&gt;setHtml($message); ]]&gt;&lt;/search&gt;\r\n		&lt;add&gt;&lt;![CDATA[						$template-&gt;build();\r\n						$template-&gt;fetch(null, $body);\r\n			\r\n						$mail = $template-&gt;hook($mail); ]]&gt;&lt;/add&gt;\r\n	&lt;/operation&gt;\r\n	&lt;operation error=&quot;skip&quot;&gt;\r\n		&lt;search position=&quot;replace&quot;&gt;&lt;![CDATA[\r\n            $mail-&gt;addAttachment($attachment[''path''], $attachment[''filename'']); ]]&gt;&lt;/search&gt;\r\n		&lt;add&gt;&lt;/add&gt;\r\n	&lt;/operation&gt;        \r\n&lt;/file&gt;\r\n	\r\n&lt;file name=&quot;admin/view/template/sale/contact.tpl&quot;&gt;\r\n	&lt;operation&gt;\r\n		&lt;search position=&quot;before&quot;&gt;&lt;![CDATA[\r\n			&lt;td&gt;&lt;?php echo $entry_to; ?&gt;&lt;/td&gt; ]]&gt;&lt;/search&gt;\r\n		&lt;add&gt;&lt;![CDATA[ \r\n			  &lt;td&gt;&lt;?php echo $entry_store_auto; ?&gt;&lt;/td&gt;\r\n			&lt;td&gt;&lt;input type=&quot;checkbox&quot; name=&quot;store_auto&quot; value=&quot;1&quot; /&gt;&lt;/td&gt;\r\n          &lt;/tr&gt;\r\n          &lt;tr&gt; ]]&gt;&lt;/add&gt;\r\n	&lt;/operation&gt;\r\n	&lt;operation info=&quot;Remove subject, add template&quot;&gt;\r\n		&lt;search position=&quot;replace&quot;&gt;&lt;![CDATA[\r\n            &lt;td&gt;&lt;span class=&quot;required&quot;&gt;*&lt;/span&gt; &lt;?php echo $entry_subject; ?&gt;&lt;/td&gt; ]]&gt;&lt;/search&gt;\r\n		&lt;add&gt;&lt;![CDATA[ \r\n		&lt;?php if(!empty($templates_options)){ ?&gt;\r\n            &lt;td&gt;&lt;?php echo $entry_template; ?&gt;&lt;/td&gt; ]]&gt;&lt;/add&gt;\r\n	&lt;/operation&gt;\r\n	&lt;operation&gt;\r\n		&lt;search regex=&quot;true&quot; position=&quot;replace&quot;&gt;&lt;![CDATA[~&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;subject&quot; value=&quot;.*?&quot; /&gt;&lt;/td&gt;~]]&gt;&lt;/search&gt;\r\n		&lt;add&gt;&lt;![CDATA[ \r\n			&lt;td&gt;\r\n            	&lt;select id=&quot;field_templates&quot; name=&quot;email_template&quot;&gt;\r\n					&lt;option value=''''&gt;&lt;?php echo $text_select; ?&gt;&lt;/option&gt;\r\n					&lt;?php foreach($templates_options as $item){ ?&gt;\r\n						&lt;option value=&quot;&lt;?php echo $item[''value'']; ?&gt;&quot;&gt;&lt;?php echo $item[''label'']; ?&gt;&lt;/option&gt;\r\n					&lt;?php } ?&gt;\r\n				&lt;/select&gt;\r\n			&lt;/td&gt;\r\n		  &lt;/tr&gt;\r\n		  &lt;tr&gt;\r\n		&lt;?php } ?&gt;           \r\n            &lt;td&gt;&lt;?php echo $entry_campaign_name; ?&gt;&lt;/td&gt;\r\n            &lt;td&gt;&lt;input value=&quot;&lt;?php echo $campaign_name; ?&gt;&quot; name=&quot;campaign_name&quot; type=&quot;text&quot; /&gt; ]]&gt;&lt;/add&gt;\r\n	&lt;/operation&gt;\r\n	&lt;operation info=&quot;Remove message&quot;&gt;\r\n		&lt;search position=&quot;replace&quot;&gt;&lt;![CDATA[\r\n            &lt;td&gt;&lt;span class=&quot;required&quot;&gt;*&lt;/span&gt; &lt;?php echo $entry_message; ?&gt;&lt;/td&gt; ]]&gt;&lt;/search&gt;\r\n		&lt;add&gt;&lt;/add&gt;\r\n	&lt;/operation&gt;\r\n	&lt;operation info=&quot;Remove message&quot;&gt;\r\n		&lt;search regex=&quot;true&quot; position=&quot;replace&quot;&gt;&lt;![CDATA[~&lt;td&gt;&lt;textarea name=&quot;message&quot;&gt;.*?&lt;/textarea&gt;~]]&gt;&lt;/search&gt;\r\n		&lt;add&gt;&lt;![CDATA[		\r\n		&lt;/tr&gt;\r\n   &lt;/table&gt;\r\n\r\n		&lt;div id=&quot;languages&quot; class=&quot;htabs&quot;&gt;\r\n			&lt;?php foreach ($languages as $language) { ?&gt;\r\n				&lt;a href=&quot;#language&lt;?php echo $language[''language_id'']; ?&gt;&quot;&gt;\r\n					&lt;img src=&quot;view/image/flags/&lt;?php echo $language[''image'']; ?&gt;&quot; title=&quot;&lt;?php echo $language[''name'']; ?&gt;&quot; /&gt; \r\n					&lt;?php echo $language[''name'']; ?&gt;\r\n				&lt;/a&gt;\r\n			&lt;?php } ?&gt;\r\n		&lt;/div&gt;\r\n\r\n		&lt;?php foreach ($languages as $language) { ?&gt;\r\n			&lt;div id=&quot;language&lt;?php echo $language[''language_id'']; ?&gt;&quot;&gt;\r\n				&lt;table class=&quot;form&quot;&gt;\r\n					&lt;tr&gt;\r\n						&lt;td&gt;&lt;span class=&quot;required&quot;&gt;*&lt;/span&gt; &lt;?php echo $entry_subject; ?&gt;&lt;/td&gt;\r\n                		&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;subject[&lt;?php echo $language[''language_id'']; ?&gt;]&quot; value=&quot;&quot; style=&quot;width:100%; max-width:500px&quot; /&gt;&lt;/td&gt;\r\n              		&lt;/tr&gt;\r\n              		&lt;tr&gt;\r\n                		&lt;td&gt;&lt;span class=&quot;required&quot;&gt;*&lt;/span&gt; &lt;?php echo $entry_message; ?&gt;&lt;/td&gt;\r\n                		&lt;td&gt;&lt;textarea name=&quot;message[&lt;?php echo $language[''language_id'']; ?&gt;]&quot; id=&quot;message_&lt;?php echo $language[''language_id'']; ?&gt;&quot;&gt;&lt;/textarea&gt;&lt;/td&gt;\r\n					&lt;/tr&gt;\r\n				&lt;/table&gt;\r\n			&lt;/div&gt;\r\n		&lt;?php } ?&gt;\r\n	&lt;table class=&quot;form&quot;&gt;\r\n		&lt;tr&gt;&lt;td&gt; ]]&gt;&lt;/add&gt;\r\n	&lt;/operation&gt;\r\n	&lt;operation info=&quot;Fix ajax send so that we can use checkboxes&quot; error=&quot;skip&quot;&gt;\r\n		&lt;search position=&quot;replace&quot;&gt;&lt;![CDATA[\r\n            data: $(''select, input, textarea''), ]]&gt;&lt;/search&gt;\r\n		&lt;add trim=&quot;true&quot;&gt;&lt;![CDATA[\r\n			data: $(''select, input, textarea'').serialize(), ]]&gt;&lt;/add&gt;\r\n	&lt;/operation&gt;\r\n	&lt;operation info=&quot;Remove ckeditor so that we can add with languages&quot; error=&quot;skip&quot;&gt;\r\n		&lt;search position=&quot;replace&quot; offset=&quot;7&quot;&gt;&lt;![CDATA[\r\n            CKEDITOR.replace(''message'', { ]]&gt;&lt;/search&gt;\r\n		&lt;add&gt;&lt;/add&gt;\r\n	&lt;/operation&gt;\r\n	&lt;operation info=&quot;Remove ckeditor so that we can add with languages&quot; error=&quot;skip&quot;&gt;\r\n		&lt;search position=&quot;replace&quot; offset=&quot;7&quot;&gt;&lt;![CDATA[\r\n            $(''textarea[name=\\''message\\'']'').ckeditor({ ]]&gt;&lt;/search&gt;\r\n		&lt;add&gt;&lt;/add&gt;\r\n	&lt;/operation&gt;\r\n	&lt;operation error=&quot;skip&quot;&gt;\r\n    	&lt;search position=&quot;replace&quot;&gt;&lt;![CDATA[\r\n			$(''textarea[name=&quot;message&quot;]'').val(CKEDITOR.instances.message.getData()); ]]&gt;&lt;/search&gt;\r\n		&lt;add&gt;&lt;![CDATA[			if(typeof CKEDITOR !== &quot;undefined&quot;){\r\n				for(var instanceName in CKEDITOR.instances){\r\n					CKEDITOR.instances[instanceName].updateElement();\r\n				} \r\n			} ]]&gt;&lt;/add&gt;\r\n	&lt;/operation&gt;\r\n	&lt;operation error=&quot;skip&quot;&gt;\r\n		&lt;search position=&quot;before&quot;&gt;&lt;![CDATA[\r\n            function send(url) { ]]&gt;&lt;/search&gt;\r\n		&lt;add&gt;&lt;![CDATA[\r\n$(''#languages a'').tabs();\r\n \r\nif(typeof CKEDITOR !== &quot;undefined&quot;){\r\n	&lt;?php foreach ($languages as $language) { ?&gt;\r\n	CKEDITOR.replace(''message_&lt;?php echo $language[''language_id'']; ?&gt;'', {\r\n		filebrowserBrowseUrl: ''index.php?route=common/filemanager&amp;token=&lt;?php echo $token; ?&gt;'',\r\n		filebrowserImageBrowseUrl: ''index.php?route=common/filemanager&amp;token=&lt;?php echo $token; ?&gt;'',\r\n		filebrowserFlashBrowseUrl: ''index.php?route=common/filemanager&amp;token=&lt;?php echo $token; ?&gt;'',\r\n		filebrowserUploadUrl: ''index.php?route=common/filemanager&amp;token=&lt;?php echo $token; ?&gt;'',\r\n		filebrowserImageUploadUrl: ''index.php?route=common/filemanager&amp;token=&lt;?php echo $token; ?&gt;'',\r\n		filebrowserFlashUploadUrl: ''index.php?route=common/filemanager&amp;token=&lt;?php echo $token; ?&gt;''\r\n	});\r\n	&lt;?php } ?&gt;\r\n\r\n	// Output dimensions of images as width and height\r\n	CKEDITOR.on(''instanceReady'', function (ev) {\r\n		ev.editor.dataProcessor.htmlFilter.addRules({\r\n			elements: {\r\n				$: function(element){                \r\n					if (element.name == ''img'') {\r\n						var style = element.attributes.style;\r\n\r\n						if (style) {\r\n							// Get the width from the style.\r\n							var match = /(?:^|\\s)width\\s*:\\s*(\\d+)px/i.exec(style),\r\n								width = match &amp;&amp; match[1];\r\n\r\n							// Get the height from the style.\r\n							match = /(?:^|\\s)height\\s*:\\s*(\\d+)px/i.exec(style);\r\n							var height = match &amp;&amp; match[1];\r\n\r\n							if (width) {\r\n								element.attributes.style = element.attributes.style.replace(/(?:^|\\s)width\\s*:\\s*(\\d+)px;?/i, '''');\r\n								element.attributes.width = width;\r\n							}\r\n\r\n							if (height) {\r\n								element.attributes.style = element.attributes.style.replace(/(?:^|\\s)height\\s*:\\s*(\\d+)px;?/i, '''');\r\n								element.attributes.height = height;\r\n							}\r\n						}\r\n					}\r\n\r\n					if (!element.attributes.style) delete element.attributes.style;\r\n\r\n					return element;\r\n				}\r\n			}\r\n		});\r\n	});\r\n} // ckeditor\r\n\r\n(function($){			\r\n	$(document).ready(function() {\r\n				\r\n		$(''select#field_templates'').change(function(){\r\n			var val = $(this).val(), \r\n				language_id, \r\n				store_id = $(''select[name=store_id]'').val();\r\n\r\n			if(!val || !confirm(&quot;&lt;?php echo $warning_template_content; ?&gt;&quot;)) return;\r\n\r\n			$.ajax({ \r\n				url: ''&lt;?php echo html_entity_decode($templates_action); ?&gt;'',\r\n				type: ''get'',\r\n				data: ''id='' + val + ''&amp;store_id='' + store_id,\r\n				dataType: ''json'',\r\n				success: function(json) {\r\n					for(i in json) {\r\n 						language_id = json[i][''language_id''];\r\n						\r\n 						if(json[i][''emailtemplate''][''subject'']){\r\n							$(&quot;input[name=''subject[&quot; + language_id + &quot;]'']&quot;).val(json[i][''emailtemplate''][''subject'']);\r\n						}\r\n\r\n						$(&quot;#message_&quot; + language_id).val(json[i][''emailtemplate''][''comment'']);\r\n\r\n						if(typeof CKEDITOR !== &quot;undefined&quot;){\r\n							CKEDITOR.instances[&quot;message_&quot; + language_id].setData(json[i][''emailtemplate''][''comment'']);\r\n						}\r\n					}\r\n				},\r\n				error: function(xhr, ajaxOptions, thrownError) {\r\n                    console.log(thrownError + &quot;\\r\\n&quot; + xhr.statusText + &quot;\\r\\n&quot; + xhr.responseText);\r\n                    alert(''Error. More details in console.'');\r\n            	}\r\n			});	\r\n		});\r\n					\r\n });	// doc.ready\r\n})(jQuery); ]]&gt;&lt;/add&gt;\r\n	&lt;/operation&gt;\r\n&lt;/file&gt;' 
 WHERE `emailtemplate_default` = 1 AND `emailtemplate_key` = 'admin.newsletter';